# 二手交易应用 - ASCII架构图

## 🏗️ 系统整体架构

```
                    📱 用户端 (Client)
                    ┌─────────────────┐
                    │   React + TS    │
                    │  Antd Mobile    │
                    │  响应式设计      │
                    └─────────┬───────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   HTTPS/SSL     │
                    │  RESTful API    │
                    │   Axios Client  │
                    └─────────┬───────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   服务端        │
                    │  Node.js +      │
                    │  Express.js     │
                    └─────────┬───────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   MongoDB       │
                    │   Atlas         │
                    │   云数据库       │
                    └─────────────────┘
```

## 📱 前端架构

```
┌─────────────────────────────────────────────────────────────┐
│                    前端应用架构                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   页面组件  │  │   业务组件  │  │   通用组件  │        │
│  │  (Pages)    │  │ (Features)  │  │  (Common)   │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • MobileHome│  │ • ProductForm│  │ • Button    │        │
│  │ • Login     │  │ • ChatWindow │  │ • Input     │        │
│  │ • Register  │  │ • UserProfile│  │ • Header    │        │
│  │ • MessageList│  │ • ProductList│  │ • Footer    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│           │               │               │                │
│           └───────────────┼───────────────┘                │
│                           │                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                状态管理 (State Management)              │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ • React Hooks (useState, useEffect)                   │ │
│  │ • Local Storage (用户状态)                             │ │
│  │ • URL State (路由参数)                                 │ │
│  └─────────────────────────────────────────────────────────┘ │
│                           │                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                路由管理 (React Router)                  │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ • 页面路由                                              │ │
│  │ • 路由守卫                                              │ │
│  │ • 嵌套路由                                              │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 后端架构

```
┌─────────────────────────────────────────────────────────────┐
│                    后端应用架构                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   路由层    │  │   控制器层  │  │   服务层    │        │
│  │  (Routes)   │  │(Controllers)│  │ (Services)  │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • userRoutes│  │ • UserCtrl  │  │ • AuthService│        │
│  │ • productR  │  │ • ProductCtrl│  │ • UploadSvc │        │
│  │ • chatRoutes│  │ • ChatCtrl  │  │ • AIService │        │
│  │ • ratingR   │  │ • RatingCtrl│  │ • SMSService│        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│           │               │               │                │
│           └───────────────┼───────────────┘                │
│                           │                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                中间件层 (Middleware)                    │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ • JWT认证                                               │ │
│  │ • 错误处理                                              │ │
│  │ • CORS跨域                                              │ │
│  │ • 限流控制                                              │ │
│  └─────────────────────────────────────────────────────────┘ │
│                           │                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                数据访问层 (Data Access)                 │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ • Mongoose ODM                                         │ │
│  │ • 数据模型 (Models)                                    │ │
│  │ • 数据库连接                                           │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 🗄️ 数据库设计

```
┌─────────────────────────────────────────────────────────────┐
│                    数据库架构                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   用户集合  │  │   商品集合  │  │   聊天集合  │        │
│  │  (Users)    │  │ (Products)  │  │   (Chats)   │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • _id       │  │ • _id       │  │ • _id       │        │
│  │ • username  │  │ • title     │  │ • participants│        │
│  │ • password  │  │ • description│  │ • createdAt │        │
│  │ • email     │  │ • price     │  │ • lastMessage│        │
│  │ • phone     │  │ • category  │  │ • unreadCount│        │
│  │ • location  │  │ • images    │  └─────────────┘        │
│  │ • avatar    │  │ • seller    │                         │
│  │ • createdAt │  │ • status    │  ┌─────────────┐        │
│  └─────────────┘  │ • createdAt │  │   消息集合  │        │
│                   └─────────────┘  │ (Messages)  │        │
│                                    ├─────────────┤        │
│  ┌─────────────┐  ┌─────────────┐  │ • _id       │        │
│  │   评价集合  │  │   举报集合  │  │ • chatId    │        │
│  │ (Ratings)   │  │ (Reports)   │  │ • sender    │        │
│  ├─────────────┤  ├─────────────┤  │ • content   │        │
│  │ • _id       │  │ • _id       │  │ • type      │        │
│  │ • productId │  │ • reporter  │  │ • createdAt │        │
│  │ • reviewer  │  │ • targetType│  └─────────────┘        │
│  │ • rating    │  │ • targetId  │                         │
│  │ • comment   │  │ • reason    │                         │
│  │ • createdAt │  │ • status    │                         │
│  └─────────────┘  │ • createdAt │                         │
│                   └─────────────┘                         │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 数据流程

```
用户操作流程:
┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐
│ 用户输入 │─▶│ 前端验证 │─▶│ API请求 │─▶│ 后端验证 │
└─────────┘  └─────────┘  └─────────┘  └─────────┘
                                              │
                                              ▼
┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐
│ 成功响应 │◀─│ 业务逻辑 │◀─│ 数据库  │◀─│ 错误处理 │
└─────────┘  └─────────┘  └─────────┘  └─────────┘

商品发布流程:
┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐
│ 表单提交 │─▶│ AI审核  │─▶│ 文件上传 │─▶│ 数据保存 │
└─────────┘  └─────────┘  └─────────┘  └─────────┘
                                              │
                                              ▼
┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐
│ 发布成功 │◀─│ 价格估算 │◀─│ 图片处理 │◀─│ 返回结果 │
└─────────┘  └─────────┘  └─────────┘  └─────────┘
```

## 🚀 部署架构

```
┌─────────────────────────────────────────────────────────────┐
│                    生产环境部署                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   前端部署  │  │   后端部署  │  │   数据库    │        │
│  │ (Frontend)  │  │ (Backend)   │  │ (Database)  │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • Railway   │  │ • Railway   │  │ • MongoDB   │        │
│  │ • Vite Build│  │ • Node.js   │  │ • Atlas     │        │
│  │ • Static    │  │ • Express   │  │ • 云存储    │        │
│  │ • CDN       │  │ • PM2       │  │ • 自动备份  │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│           │               │               │                │
│           └───────────────┼───────────────┘                │
│                           │                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                外部服务集成                              │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ • OpenAI API (内容审核)                                 │ │
│  │ • Hugging Face (AI服务)                                 │ │
│  │ • SMS Gateway (短信服务)                                │ │
│  │ • Email Service (邮件服务)                              │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 📊 技术栈总结

```
前端技术栈:
┌─────────────────────────────────────────────────────────────┐
│ React 18 + TypeScript + Vite + Antd Mobile                │
│ ├── 状态管理: React Hooks                                  │
│ ├── 路由管理: React Router v6                              │
│ ├── HTTP客户端: Axios                                      │
│ ├── 样式系统: CSS Modules + Emotion                        │
│ └── 构建工具: Vite                                         │
└─────────────────────────────────────────────────────────────┘

后端技术栈:
┌─────────────────────────────────────────────────────────────┐
│ Node.js + Express.js + MongoDB + Mongoose                 │
│ ├── 认证系统: JWT + bcrypt                                 │
│ ├── 文件上传: Multer                                       │
│ ├── 数据验证: Express Validator                            │
│ ├── AI集成: OpenAI + Hugging Face                         │
│ └── 部署平台: Railway                                      │
└─────────────────────────────────────────────────────────────┘

数据库设计:
┌─────────────────────────────────────────────────────────────┐
│ MongoDB Atlas (云数据库)                                   │
│ ├── 用户集合: Users (用户信息)                             │
│ ├── 商品集合: Products (商品信息)                          │
│ ├── 聊天集合: Chats + Messages (聊天数据)                  │
│ ├── 评价集合: Ratings + Reports (评价举报)                 │
│ └── 索引设计: 用户名、邮箱、手机号唯一索引                  │
└─────────────────────────────────────────────────────────────┘
```

## 🎯 项目亮点

```
✅ 已完成功能:
├── 用户系统 (注册/登录/认证)
├── 商品系统 (发布/搜索/展示)
├── 聊天系统 (实时消息)
├── 安全系统 (AI审核/举报)
├── 移动端适配 (响应式设计)
└── 云平台部署 (自动化运维)

🚀 技术优势:
├── 现代化技术栈 (React + Node.js)
├── 移动端优先 (Antd Mobile)
├── AI智能服务 (内容审核/价格估算)
├── 云原生架构 (Railway + MongoDB Atlas)
└── 安全可靠 (JWT + HTTPS + 数据验证)

💰 商业价值:
├── 目标用户: 留学生群体
├── 盈利模式: 交易佣金 + 广告服务
├── 发展潜力: 可扩展到其他城市
└── 投资回报: 预期年化收益率100%+
```

---

*此ASCII架构图直观展示了项目的技术架构和商业价值，适合向阮总汇报项目进展。*
